  tags = {
>     Name        = "app-${terraform.workspace}"
>     Environment = local.base_environment
>     Branch      = terraform.workspace
>     Temporary   = local.is_feature_branch ? "true" : "false"
>   }
>   
>   # 기능 브랜치는 자동 종료 설정
>   user_data = local.is_feature_branch ? file("scripts/auto-shutdown.sh") : null
> }
> ```

### 패턴 3: 지역별 배포

> [!example] 멀티 리전 관리
> ```hcl
> # workspace: us-west-2, eu-west-1, ap-northeast-1
> 
> locals {
>   region_config = {
>     "us-west-2" = {
>       vpc_cidr = "10.1.0.0/16"
>       azs      = ["us-west-2a", "us-west-2b", "us-west-2c"]
>     }
>     "eu-west-1" = {
>       vpc_cidr = "10.2.0.0/16"
>       azs      = ["eu-west-1a", "eu-west-1b", "eu-west-1c"]
>     }
>     "ap-northeast-1" = {
>       vpc_cidr = "10.3.0.0/16"
>       azs      = ["ap-northeast-1a", "ap-northeast-1c", "ap-northeast-1d"]
>     }
>   }
>   
>   config = local.region_config[terraform.workspace]
> }
> 
> provider "aws" {
>   region = terraform.workspace
> }
> 
> module "regional_infrastructure" {
>   source = "./modules/regional"
>   
>   region   = terraform.workspace
>   vpc_cidr = local.config.vpc_cidr
>   azs      = local.config.azs
> }
> ```

---

## ⚠️ 주의사항과 한계

### 워크스페이스의 한계

> [!warning] 알아야 할 제한사항
> 1. **가시성 부족**: 현재 워크스페이스를 명확히 알기 어려움
> 2. **실수 위험**: 잘못된 워크스페이스에서 작업할 가능성
> 3. **협업 어려움**: 팀원이 어느 워크스페이스에서 작업 중인지 파악 어려움
> 4. **코드 복잡성**: 많은 조건문으로 코드가 복잡해질 수 있음
> 5. **상태 파일 관리**: 워크스페이스별 상태 파일 백업/복구 복잡

### 안전장치 구현

> [!tip] 실수 방지 방법
> ```hcl
> # 프로덕션 환경 보호
> variable "confirm_production" {
>   description = "프로덕션 배포 확인"
>   type        = bool
>   default     = false
> }
> 
> resource "null_resource" "production_check" {
>   count = terraform.workspace == "production" && !var.confirm_production ? 1 : 0
>   
>   provisioner "local-exec" {
>     command = "echo 'ERROR: Production deployment requires confirm_production=true' && exit 1"
>   }
> }
> 
> # 워크스페이스 확인 출력
> output "current_workspace" {
>   value = "현재 워크스페이스: ${terraform.workspace}"
> }
> 
> output "warning" {
>   value = terraform.workspace == "production" ? "⚠️  프로덕션 환경입니다!" : ""
> }
> ```

### 대안 고려사항

> [!note] 워크스페이스 대신 사용할 수 있는 방법
> - **별도 디렉토리**: 환경별로 완전히 분리된 디렉토리 구조
> - **Git 브랜치**: 환경별 브랜치 전략
> - **Terragrunt**: DRY 원칙을 지키며 환경 관리
> - **Terraform Cloud**: 더 강력한 워크스페이스 기능 제공

---

## ✨ 베스트 프랙티스

### 워크스페이스 네이밍 컨벤션

> [!success] 권장 네이밍 규칙
> ```bash
> # 환경별
> terraform workspace new dev
> terraform workspace new staging
> terraform workspace new production
> 
> # 지역별
> terraform workspace new us-west-2
> terraform workspace new eu-central-1
> 
> # 기능 브랜치
> terraform workspace new feature-auth-system
> terraform workspace new hotfix-db-connection
> ```

### 자동화 스크립트

> [!example] 배포 자동화
> ```bash
> #!/bin/bash
> # deploy.sh
> 
> set -e
> 
> ENVIRONMENT=$1
> 
> if [ -z "$ENVIRONMENT" ]; then
>   echo "Usage: ./deploy.sh [dev|staging|production]"
>   exit 1
> fi
> 
> # 워크스페이스 확인 및 생성
> if ! terraform workspace list | grep -q "$ENVIRONMENT"; then
>   echo "Creating workspace: $ENVIRONMENT"
>   terraform workspace new "$ENVIRONMENT"
> else
>   echo "Switching to workspace: $ENVIRONMENT"
>   terraform workspace select "$ENVIRONMENT"
> fi
> 
> # 현재 워크스페이스 확인
> CURRENT=$(terraform workspace show)
> echo "Current workspace: $CURRENT"
> 
> # 프로덕션 확인
> if [ "$CURRENT" = "production" ]; then
>   read -p "⚠️  Production deployment. Continue? (y/N): " confirm
>   if [ "$confirm" != "y" ]; then
>     echo "Deployment cancelled"
>     exit 1
>   fi
> fi
> 
> # 변수 파일 선택
> VAR_FILE="environments/${ENVIRONMENT}.tfvars"
> 
> if [ ! -f "$VAR_FILE" ]; then
>   echo "Variable file not found: $VAR_FILE"
>   exit 1
> fi
> 
> # Terraform 실행
> terraform init
> terraform plan -var-file="$VAR_FILE"
> 
> read -p "Apply changes? (y/N): " apply
> if [ "$apply" = "y" ]; then
>   terraform apply -var-file="$VAR_FILE" -auto-approve
> fi
> ```

### 모니터링과 알림

> [!tip] 워크스페이스 활동 추적
> ```hcl
> # 워크스페이스 정보를 태그로 추가
> locals {
>   default_tags = {
>     Workspace      = terraform.workspace
>     LastModified   = timestamp()
>     ManagedBy      = "Terraform"
>     Repository     = var.repository_url
>   }
> }
> 
> # 모든 리소스에 태그 적용
> provider "aws" {
>   default_tags {
>     tags = local.default_tags
>   }
> }
> ```

---

## 📚 참고자료

### 관련 문서
- [[Terraform 기초]]
- [[Terraform 명령어]]
- [[06. Terraform 상태 관리]]
- [[09. Terraform 모듈]]

### 외부 리소스
- [Terraform Workspaces 공식 문서](https://www.terraform.io/docs/language/state/workspaces.html)
- [Workspace 베스트 프랙티스](https://www.terraform.io/docs/cloud/guides/recommended-practices/part1.html)
- [Terragrunt로 DRY 인프라 관리](https://terragrunt.gruntwork.io/)

---

> [!quote]
> "워크스페이스는 강력한 도구이지만, 모든 문제의 해결책은 아닙니다. 상황에 맞는 올바른 도구를 선택하는 것이 중요합니다."