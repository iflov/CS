---
tags:
- terraform
- provider
- infrastructure
- cloud
- advanced
created: 2025-01-15
updated: 2025-01-15
aliases:
- Terraform Providers
- 테라폼 프로바이더
description: Terraform Provider의 이해와 주요 Provider 활용 가이드
status: published
category: guide
---

# Terraform 프로바이더

> [!info] 개요
> Terraform Provider는 Terraform이 다양한 클라우드 플랫폼, SaaS 서비스, 온프레미스 솔루션과 상호작용할 수 있게 해주는 플러그인입니다. 이 가이드에서는 주요 Provider의 설정과 활용 방법, 멀티 Provider 전략을 다룹니다.

## 📑 목차

- [[#🎯 Provider란?]]
- [[#⚙️ Provider 설정]]
- [[#☁️ 주요 Cloud Provider]]
- [[#🔧 SaaS/PaaS Provider]]
- [[#🔄 Multi-Provider 전략]]
- [[#🔐 Provider 인증]]
- [[#📦 Custom Provider]]
- [[#💡 실전 활용 예제]]
- [[#✨ 베스트 프랙티스]]
- [[#📚 참고자료]]

---

## 🎯 Provider란?

> [!note] Provider의 역할
> Provider는 Terraform과 외부 API 간의 브리지 역할을 합니다. 각 Provider는 해당 플랫폼의 리소스를 생성, 읽기, 업데이트, 삭제(CRUD)할 수 있는 기능을 제공합니다.

### Provider 구조

```hcl
# Provider 선언
terraform {
  required_providers {
    aws = {
      source  = "hashicorp/aws"      # Provider 소스
      version = "~> 5.0"              # 버전 제약
    }
  }
}

# Provider 설정
provider "aws" {
  region = "us-west-2"                # Provider별 설정
}
```

---

## ⚙️ Provider 설정

### 기본 설정

> [!example] Provider 기본 구성
> ```hcl
> # versions.tf
> terraform {
>   required_version = ">= 1.0"
>   
>   required_providers {
>     aws = {
>       source  = "hashicorp/aws"
>       version = "~> 5.0"
>     }
>     
>     azurerm = {
>       source  = "hashicorp/azurerm"
>       version = "~> 3.0"
>     }
>     
>     google = {
>       source  = "hashicorp/google"
>       version = "~> 5.0"
>     }
>   }
> }
> ```

### Provider Alias

> [!tip] 동일 Provider 다중 설정
> ```hcl
> # 여러 리전 사용
> provider "aws" {
>   alias  = "us_west"
>   region = "us-west-2"
> }
> 
> provider "aws" {
>   alias  = "eu_west"
>   region = "eu-west-1"
> }
> 
> # 리소스에서 사용
> resource "aws_instance" "us_server" {
>   provider = aws.us_west
>   # ...
> }
> 
> resource "aws_instance" "eu_server" {
>   provider = aws.eu_west
>   # ...
> }
> ```

---

## ☁️ 주요 Cloud Provider

### AWS Provider

> [!example] AWS Provider 상세 설정
> ```hcl
> provider "aws" {
>   region = var.aws_region
>   
>   # 인증 (환경변수 사용 권장)
>   # access_key = var.aws_access_key
>   # secret_key = var.aws_secret_key
>   
>   # AssumeRole
>   assume_role {
>     role_arn     = "arn:aws:iam::123456789012:role/TerraformRole"
>     session_name = "TerraformSession"
>   }
>   
>   # 기본 태그
>   default_tags {
>     tags = {
>       Environment = var.environment
>       ManagedBy   = "Terraform"
>       Project     = var.project_name
>     }
>   }
>   
>   # 추가 설정
>   max_retries = 3
>   
>   endpoints {
>     s3 = "http://localhost:4566"  # LocalStack 사용 시
>   }
> }
> 
> # AWS 리소스 예제
> resource "aws_vpc" "main" {
>   cidr_block = "10.0.0.0/16"
>   
>   enable_dns_hostnames = true
>   enable_dns_support   = true
> }
> 
> resource "aws_s3_bucket" "data" {
>   bucket = "${var.project_name}-data-${var.environment}"
> }
> 
> resource "aws_lambda_function" "processor" {
>   function_name = "${var.project_name}-processor"
>   runtime       = "python3.9"
>   handler       = "index.handler"
>   # ...
> }
> ```

### Azure Provider

> [!example] Azure Provider 설정
> ```hcl
> provider "azurerm" {
>   features {
>     resource_group {
>       prevent_deletion_if_contains_resources = true
>     }
>     
>     virtual_machine {
>       delete_os_disk_on_deletion = true
>     }
>   }
>   
>   subscription_id = var.azure_subscription_id
>   tenant_id       = var.azure_tenant_id
>   
>   # Service Principal 인증
>   # client_id     = var.azure_client_id
>   # client_secret = var.azure_client_secret
> }
> 
> # Azure 리소스 예제
> resource "azurerm_resource_group" "main" {
>   name     = "${var.project_name}-rg"
>   location = var.azure_region
> }
> 
> resource "azurerm_virtual_network" "main" {
>   name                = "${var.project_name}-vnet"
>   address_space       = ["10.0.0.0/16"]
>   location            = azurerm_resource_group.main.location
>   resource_group_name = azurerm_resource_group.main.name
> }
> ```

### Google Cloud Provider

> [!example] GCP Provider 설정
> ```hcl
> provider "google" {
>   project = var.gcp_project_id
>   region  = var.gcp_region
>   zone    = var.gcp_zone
>   
>   # 서비스 계정 키 파일
>   # credentials = file("service-account.json")
> }
> 
> # GCP 리소스 예제
> resource "google_compute_network" "vpc" {
>   name                    = "${var.project_name}-vpc"
>   auto_create_subnetworks = false
> }
> 
> resource "google_compute_subnetwork" "subnet" {
>   name          = "${var.project_name}-subnet"
>   ip_cidr_range = "10.0.1.0/24"
>   region        = var.gcp_region
>   network       = google_compute_network.vpc.id
> }
> 
> resource "google_storage_bucket" "data" {
>   name          = "${var.project_name}-data-${var.environment}"
>   location      = var.gcp_region
>   force_destroy = var.environment != "production"
> }
> ```

---

## 🔧 SaaS/PaaS Provider

### Kubernetes Provider

> [!tip] Kubernetes Provider 설정
> ```hcl
> provider "kubernetes" {
>   host = var.kubernetes_host
>   
>   # 여러 인증 방법
>   # 1. kubeconfig 파일
>   config_path = "~/.kube/config"
>   
>   # 2. 인라인 설정
>   # client_certificate     = base64decode(var.client_cert)
>   # client_key            = base64decode(var.client_key)
>   # cluster_ca_certificate = base64decode(var.cluster_ca)
>   
>   # 3. EKS 토큰
>   # exec {
>   #   api_version = "client.authentication.k8s.io/v1beta1"
>   #   command     = "aws"
>   #   args = ["eks", "get-token", "--cluster-name", var.cluster_name]
>   # }
> }
> 
> resource "kubernetes_namespace" "app" {
>   metadata {
>     name = var.app_namespace
>   }
> }
> 
> resource "kubernetes_deployment" "app" {
>   metadata {
>     name      = var.app_name
>     namespace = kubernetes_namespace.app.metadata[0].name
>   }
>   
>   spec {
>     replicas = var.app_replicas
>     
>     selector {
>       match_labels = {
>         app = var.app_name
>       }
>     }
>     
>     template {
>       metadata {
>         labels = {
>           app = var.app_name
>         }
>       }
>       
>       spec {
>         container {
>           image = var.app_image
>           name  = var.app_name
>         }
>       }
>     }
>   }
> }
> ```

### GitHub Provider

> [!example] GitHub Provider 활용
> ```hcl
> provider "github" {
>   token = var.github_token
>   owner = var.github_organization
> }
> 
> resource "github_repository" "app" {
>   name        = var.repo_name
>   description = var.repo_description
>   visibility  = "private"
>   
>   has_issues    = true
>   has_wiki      = true
>   has_downloads = false
>   
>   template {
>     owner      = var.github_organization
>     repository = "template-repo"
>   }
> }
> 
> resource "github_branch_protection" "main" {
>   repository_id = github_repository.app.node_id
>   pattern       = "main"
>   
>   required_status_checks {
>     strict   = true
>     contexts = ["continuous-integration"]
>   }
>   
>   required_pull_request_reviews {
>     required_approving_review_count = 2
>     dismiss_stale_reviews          = true
>   }
> }
> ```

### Datadog Provider

> [!example] Monitoring Provider
> ```hcl
> provider "datadog" {
>   api_key = var.datadog_api_key
>   app_key = var.datadog_app_key
>   api_url = "https://api.datadoghq.com/"
> }
> 
> resource "datadog_monitor" "cpu_alert" {
>   name    = "High CPU Usage Alert"
>   type    = "metric alert"
>   message = "CPU usage is too high! @slack-alerts"
>   
>   query = "avg(last_5m):avg:system.cpu.user{environment:production} > 80"
>   
>   monitor_thresholds {
>     warning  = 70
>     critical = 80
>   }
>   
>   tags = ["environment:production", "team:devops"]
> }
> ```

---

## 🔄 Multi-Provider 전략

### 멀티 클라우드 아키텍처

> [!tip] 여러 클라우드 Provider 함께 사용
> ```hcl
> # AWS와 Azure를 함께 사용
> provider "aws" {
>   region = "us-west-2"
> }
> 
> provider "azurerm" {
>   features {}
> }
> 
> # AWS에 메인 애플리케이션
> resource "aws_instance" "app" {
>   ami           = "ami-123456"
>   instance_type = "t3.large"
> }
> 
> # Azure에 백업 스토리지
> resource "azurerm_storage_account" "backup" {
>   name                     = "backupstorage"
>   resource_group_name      = azurerm_resource_group.backup.name
>   location                 = azurerm_resource_group.backup.location
>   account_tier             = "Standard"
>   account_replication_type = "GRS"
> }
> 
> # 크로스 클라우드 연결
> resource "aws_vpc_peering_connection" "cross_cloud" {
>   # AWS VPC와 Azure VNet 연결 설정
>   # ...
> }
> ```

### Provider 간 데이터 공유

> [!example] Provider 간 정보 전달
> ```hcl
> # AWS에서 생성한 리소스 정보를 Kubernetes Provider에서 사용
> resource "aws_eks_cluster" "main" {
>   name     = var.cluster_name
>   role_arn = aws_iam_role.eks.arn
>   # ...
> }
> 
> # EKS 클러스터 정보를 사용해 Kubernetes Provider 설정
> provider "kubernetes" {
>   host                   = aws_eks_cluster.main.endpoint
>   cluster_ca_certificate = base64decode(aws_eks_cluster.main.certificate_authority[0].data)
>   
>   exec {
>     api_version = "client.authentication.k8s.io/v1beta1"
>     command     = "aws"
>     args = ["eks", "get-token", "--cluster-name", aws_eks_cluster.main.name]
>   }
> }
> 
> # Kubernetes 리소스 배포
> resource "kubernetes_deployment" "app" {
>   depends_on = [aws_eks_cluster.main]
>   # ...
> }
> ```

---

## 🔐 Provider 인증

### 환경변수 사용

> [!success] 권장 인증 방법
> ```bash
> # AWS
> export AWS_ACCESS_KEY_ID="xxx"
> export AWS_SECRET_ACCESS_KEY="xxx"
> export AWS_DEFAULT_REGION="us-west-2"
> 
> # Azure
> export ARM_CLIENT_ID="xxx"
> export ARM_CLIENT_SECRET="xxx"
> export ARM_SUBSCRIPTION_ID="xxx"
> export ARM_TENANT_ID="xxx"
> 
> # GCP
> export GOOGLE_APPLICATION_CREDENTIALS="/path/to/service-account.json"
> export GOOGLE_PROJECT="my-project"
> ```

### Vault 통합

> [!tip] HashiCorp Vault로 자격증명 관리
> ```hcl
> provider "vault" {
>   address = "https://vault.example.com"
> }
> 
> data "vault_aws_access_credentials" "creds" {
>   backend = "aws"
>   role    = "terraform-role"
> }
> 
> provider "aws" {
>   access_key = data.vault_aws_access_credentials.creds.access_key
>   secret_key = data.vault_aws_access_credentials.creds.secret_key
> }
> ```

---

## 📦 Custom Provider

### Provider 개발 기초

> [!note] Custom Provider 구조
> ```go
> // main.go - Provider 진입점
> package main
> 
> import (
>     "github.com/hashicorp/terraform-plugin-sdk/v2/plugin"
>     "github.com/example/terraform-provider-custom/internal/provider"
> )
> 
> func main() {
>     plugin.Serve(&plugin.ServeOpts{
>         ProviderFunc: provider.New,
>     })
> }
> ```

---

## 💡 실전 활용 예제

### 하이브리드 클라우드 설정

> [!example] AWS + 온프레미스 연동
> ```hcl
> # AWS Provider
> provider "aws" {
>   region = "us-west-2"
> }
> 
> # VMware vSphere Provider (온프레미스)
> provider "vsphere" {
>   user           = var.vsphere_user
>   password       = var.vsphere_password
>   vsphere_server = var.vsphere_server
>   
>   allow_unverified_ssl = true
> }
> 
> # AWS 리소스
> resource "aws_vpc" "cloud" {
>   cidr_block = "10.0.0.0/16"
> }
> 
> resource "aws_vpn_gateway" "cloud" {
>   vpc_id = aws_vpc.cloud.id
> }
> 
> # 온프레미스 VM
> resource "vsphere_virtual_machine" "onprem" {
>   name             = "app-server"
>   resource_pool_id = data.vsphere_resource_pool.pool.id
>   datastore_id     = data.vsphere_datastore.datastore.id
>   
>   num_cpus = 2
>   memory   = 4096
>   
>   network_interface {
>     network_id = data.vsphere_network.network.id
>   }
> }
> 
> # Site-to-Site VPN 연결
> resource "aws_customer_gateway" "onprem" {
>   bgp_asn    = 65000
>   ip_address = var.onprem_public_ip
>   type       = "ipsec.1"
> }
> 
> resource "aws_vpn_connection" "main" {
>   vpn_gateway_id      = aws_vpn_gateway.cloud.id
>   customer_gateway_id = aws_customer_gateway.onprem.id
>   type                = "ipsec.1"
> }
> ```

---

## ✨ 베스트 프랙티스

> [!success] Provider 사용 권장사항
> 1. **버전 고정**: 예측 가능한 동작을 위해 항상 버전 지정
> 2. **환경변수 사용**: 자격증명을 코드에 하드코딩하지 않음
> 3. **Provider 별칭**: 멀티 리전/계정 관리 시 활용
> 4. **최소 권한**: Provider에 필요한 최소한의 권한만 부여
> 5. **Provider 문서화**: 팀원을 위한 설정 가이드 작성
> 6. **테스트 환경**: LocalStack 등으로 로컬 테스트 환경 구축

---

## 📚 참고자료

### 관련 문서
- [[Terraform 기초]]
- [[09. Terraform 모듈]]
- [[10. Terraform 워크스페이스]]

### 외부 리소스
- [Terraform Registry - Providers](https://registry.terraform.io/browse/providers)
- [Provider 개발 가이드](https://www.terraform.io/docs/extend/writing-custom-providers.html)
- [AWS Provider 문서](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)
- [Azure Provider 문서](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)
- [Google Provider 문서](https://registry.terraform.io/providers/hashicorp/google/latest/docs)

---

> [!quote]
> "Provider는 Terraform의 손과 발입니다. 올바른 Provider 선택과 설정이 성공적인 인프라 자동화의 시작입니다."