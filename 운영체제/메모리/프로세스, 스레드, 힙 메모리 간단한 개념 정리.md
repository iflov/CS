# 🧠 프로세스, 스레드, 힙 메모리 근본 개념 정리

---

## 📌 1. 프로세스(Process)란?

> 운영체제가 하나의 프로그램을 실행할 때 생성되는 "독립적인 실행 단위"

### ✅ 핵심 특징

- **독립된 메모리 공간**을 가지며, 다른 프로세스와는 메모리를 공유하지 않음
    
- 코드, 데이터, 힙, 스택 영역을 포함한 고유한 메모리 구조를 갖음
    
- 최소 1개 이상의 **스레드(Thread)**를 포함함
    
- 운영체제는 각 프로세스에 **PID(Process ID)**를 부여하여 관리함
    

### ✅ 예시

- VSCode 실행 → 하나의 프로세스
    
- 브라우저에서 탭 3개 열기 → 크롬 내부적으로는 3개 이상의 프로세스로 관리됨
    
- `python main.py` 실행 → 파이썬 인터프리터 프로세스
    

---

## 📌 2. 스레드(Thread)란?

> 프로세스 내에서 실행되는 **최소 실행 단위**로, CPU 스케줄링의 대상

### ✅ 핵심 특징

- 하나의 프로세스 안에서 여러 스레드가 동작 가능 (멀티스레딩)
    
- **코드, 데이터, 힙은 공유**, 스택(Stack)은 각 스레드가 독립적으로 가짐
    
- 비용이 적고 생성이 빠르며, 자원 공유가 쉬워 효율적
    

### ✅ 장점과 단점

- 장점: 문맥 전환 비용이 낮고, 자원 공유로 통신 비용 절감
    
- 단점: 스레드 간 자원 충돌 위험, 하나의 스레드가 오류 나면 프로세스 전체가 영향을 받을 수 있음
    

### ✅ 예시

- 웹 서버에서 각 클라이언트 요청을 처리하는 스레드
    
- 게임 엔진에서 물리 연산, 렌더링, AI 연산을 각각 스레드로 분리
    

---

## 📌 3. 힙(Heap) 메모리란?

> 프로그램 실행 중 동적으로 생성되는 객체들이 저장되는 메모리 영역

### ✅ 특징

- 프로그램이 `new`, `malloc`, `list = []`, `dict = {}` 등을 호출할 때 할당
    
- Python, Java, C++ 등 대부분 언어에서 힙은 런타임에 할당됨
    
- **스레드 간 공유됨** → ThreadPool에서도 공용 자원 관리 가능
    

### ✅ Python에서의 예시

```python
my_list = []         # 힙에 저장
my_dict = {"a": 1}   # 힙에 저장
my_array = np.zeros((100, 100))  # 힙에 저장
```

- 이 데이터는 전부 힙 메모리에 저장되고, GC(Garbage Collector)가 회수함
    

---

## 🧠 메모리 레이아웃 다이어그램 (프로세스 내부)

```
+------------------------+ ← 높은 주소
|        스택(Stack)      | 함수 호출 시 지역 변수, 반환 주소 등 저장
|------------------------|
|        힙(Heap)         | 동적으로 생성된 객체 (list, dict, ndarray 등)
|------------------------|
|    데이터(Data) 영역      | 전역 변수, static 변수
|------------------------|
|    코드(Code) 영역       | 실제 실행 코드
+------------------------+ ← 낮은 주소
```

- 스택은 **위에서 아래 방향**으로 자람 (재귀 호출 시 Stack Overflow 발생 가능) [[스택(STACK)]]
- 
    
- 힙은 **아래에서 위 방향**으로 자람 (무한 할당 시 Out Of Memory 발생 가능)
    

---

## 🛠️ 실무 예제: Python에서 ThreadPoolExecutor 활용

```python
from concurrent.futures import ThreadPoolExecutor
import threading

shared_list = []
lock = threading.Lock()

def worker(id):
    with lock:
        shared_list.append(f"Thread {id} 작업 완료")

with ThreadPoolExecutor(max_workers=4) as pool:
    for i in range(4):
        pool.submit(worker, i)

print(shared_list)
```

- `shared_list`는 **Heap에 저장된 자원**이고, 모든 스레드가 접근 가능
    
- `lock`으로 **데이터 경합(Race Condition)**을 방지함
    

---

## ✅ 요약 정리

|개념|설명|
|---|---|
|프로세스|독립된 실행 단위, 메모리 분리됨|
|스레드|프로세스 내 실행 단위, Stack 독립 + Heap 공유|
|힙 메모리|런타임 중 생성된 동적 객체 저장 영역|
|스택 메모리|함수 호출 시 지역 변수, return 주소 등 저장|

---

## 🧠 확장 개념 (심화 학습 추천)

- ✅ **Garbage Collection (GC)**: 힙 메모리 자동 회수 메커니즘 [[♻️ Garbage Collection (GC) 완전 정리]]
    
- ✅ **ThreadPoolExecutor vs ProcessPoolExecutor**
    
- ✅ **GIL (Global Interpreter Lock)**: Python의 멀티스레딩 제약 요인
    
- ✅ **메모리 누수 (Memory Leak)**: GC가 수거하지 못한 객체의 축적
    
- ✅ **IPC (Inter Process Communication)**: 프로세스 간 통신 (Pipe, Socket, Queue 등)